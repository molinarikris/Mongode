var mongo=require("mongodb").MongoClient,assert=require("assert"),dbConfig=function(a,b,c){var d=a,e=b;return{connection:function(a){mongo.connect("mongodb://localhost:27017/"+d,function(b,c){b?a(b):a(null,c)})},read:function(a,b){this.connection(function(c,d){c?b(c):"object"==typeof a&&a?d.collection(e).find(a).toArray(function(a,c){a?b(a):b(null,c)}):"function"==typeof a?d.collection(e).find().toArray(function(b,c){b?a(b):a(null,c)}):d.collection(e).find().toArray(function(a,c){a?b(a):b(null,c)})})},count:function(a){this.connection(function(b,c){c.collection(e).find().count(function(b,c){a(b,c)})})},create:function(a,b){this.connection(function(c,d){c?b(c):d.collection(e).insert(a,function(a,c){a?b(a):b(null,c)})})},"delete":function(a,b){this.connection(function(c,d){c?b(c):b||"function"!=typeof a?"object"==typeof a&&a&&"function"==typeof b&&d.collection(e).remove(a,function(a,c){a?b(a):b(null,c)}):a(new Error("You cannot use delete without a valid query"))})},update:function(a,b,c,d){this.connection(function(f,g){var h;f?d(f):"function"==typeof c?(h={upsert:!1,multi:!0},g.collection(e).update(a,b,h,function(a,b){a?c(a):c(null,b)})):(h={upsert:c.upsert||!1,multi:c.multi||!0},g.collection(e).update(a,b,h,function(a,b){a?d(a):d(null,b)}))})}}};module.exports=dbConfig;